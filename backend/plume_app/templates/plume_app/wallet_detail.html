{% comment %} {% extends "plume_app/base.html" %}

{% block content %}
<div class="row">
    <div class="col-md-4">
        <div class="card mb-4">
            <div class="card-header">
                <h4>Wallet Overview</h4>
            </div>
            <div class="card-body">
                <p><strong>Address:</strong> {{ wallet_address }}</p>
                <p><strong>Rank:</strong> {{ wallet_stats.stats.xpRank }}</p>
                <p><strong>Total XP:</strong> {{ wallet_stats.stats.totalXp }}</p>
                <p><strong>Self XP:</strong> {{ wallet_stats.stats.userSelfXp }}</p>
                <p><strong>Referral XP:</strong> {{ wallet_stats.stats.referralBonusXp }}</p>
                <p><strong>TVL:</strong> ${{ wallet_stats.stats.realTvlUsd|floatformat:2 }}</p>
                <p><strong>Swap Volume:</strong> ${{ wallet_stats.stats.swapVolume|floatformat:2 }}</p>
                <p><strong>Daily Spin Streak:</strong> {{ wallet_stats.stats.dailySpinStreak }}</p>
            </div>
        </div>

        <div class="card mb-4">
            <div class="card-header">
                <h4>Social Connections</h4>
            </div>
            <div class="card-body">
                {% if social_connections.discord %}
                <p><strong>Discord:</strong> {{ social_connections.discord.username }}</p>
                {% endif %}
                {% if social_connections.twitter %}
                <p><strong>Twitter:</strong> {{ social_connections.twitter.username }}</p>
                {% endif %}
                <p><strong>Sky Society Tier:</strong> {{ social_connections.skySocietyTier|title }}</p>
            </div>
        </div>
    </div>

    <div class="col-md-8">
        <div class="card mb-4">
            <div class="card-header">
                <h4>Badges</h4>
            </div>
            <div class="card-body">
                <div class="row">
                    {% for badge in wallet_badges %}
                    {% if badge.earnedAt %}
                    <div class="col-md-4 mb-3">
                        <div class="card">
                            <div class="card-body">
                                <h6>{{ badge.title }}</h6>
                                <p class="small">{{ badge.description }}</p>
                                <span class="badge bg-success">Earned</span>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h4>Daily Spin History</h4>
            </div>
            <div class="card-body">
                <canvas id="spinChart" height="100"></canvas>
                <table class="table mt-3">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Reward</th>
                            <th>Amount</th>
                            <th>Streak</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for spin in daily_spins %}
                        <tr>
                            <td>{{ spin.dateStr }}</td>
                            <td>{{ spin.rewardCategory }}</td>
                            <td>{{ spin.rewardAmount }}</td>
                            <td>{{ spin.streak }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
    const ctx = document.getElementById('spinChart').getContext('2d');
    const spinChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: [{% for spin in daily_spins %}'{{ spin.dateStr }}'{% if not forloop.last %},{% endif %}{% endfor %}],
            datasets: [{
                label: 'Spin Reward Amount',
                data: [{% for spin in daily_spins %}{{ spin.rewardAmount }}{% if not forloop.last %},{% endif %}{% endfor %}],
                backgroundColor: 'rgba(54, 162, 235, 0.5)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });
</script>
{% endblock %}
{% endblock %} {% endcomment %}
{% extends "plume_app/base.html" %}

{% block content %}
<div class="container">
    <h2 class="my-4">Wallet Details: {{ wallet_address|truncatechars:16 }}</h2>
    
    <div class="row">
        <!-- Primera columna - Stats principales -->
        <div class="col-md-6">
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h5>Basic Stats</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>Rank:</strong> {{ wallet_stats.stats.xpRank }}</p>
                            <p><strong>Total XP:</strong> {{ wallet_stats.stats.totalXp }}</p>
                            <p><strong>Self XP:</strong> {{ wallet_stats.stats.userSelfXp }}</p>
                            <p><strong>Referral XP:</strong> {{ wallet_stats.stats.referralBonusXp }}</p>
                        </div>
                        <div class="col-md-6">
                            <p><strong>TVL:</strong> ${{ wallet_stats.stats.realTvlUsd|floatformat:2 }}</p>
                            <p><strong>Swap Volume:</strong> ${{ wallet_stats.stats.swapVolume|floatformat:2 }}</p>
                            <p><strong>Protocols Used:</strong> {{ wallet_stats.stats.protocolsUsed }}</p>
                            <p><strong>Daily Spin Streak:</strong> {{ wallet_stats.stats.dailySpinStreak }}</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mb-4">
                <div class="card-header bg-info text-white">
                    <h5>Staking & Rewards</h5>
                </div>
                <div class="card-body">
                    <p><strong>Plume Staked:</strong> {{ wallet_stats.stats.plumeStaked }} PLUME</p>
                    <p><strong>Staking Streak:</strong> {{ wallet_stats.stats.plumeStakingStreak }} days</p>
                    <p><strong>Staking Points:</strong> {{ wallet_stats.stats.plumeStakingPointsEarned }}</p>
                    <p><strong>Bonus Points:</strong> {{ wallet_stats.stats.plumeStakingBonusPointsEarned }}</p>
                    <p><strong>Airdrop S1:</strong> {{ wallet_stats.seasonOneAllocation.calculatedTotal }} PLUME</p>
                </div>
            </div>
        </div>

        <!-- Segunda columna - Protocolos y Battle Group -->
        <div class="col-md-6">
            <div class="card mb-4">
                <div class="card-header bg-success text-white">
                    <h5>Top Protocols</h5>
                </div>
                <div class="card-body">
                    <div class="list-group">
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            {{ wallet_stats.stats.protocol1|title }}
                            <span class="badge bg-primary rounded-pill">{{ wallet_stats.stats.daysUsed1 }} days</span>
                        </div>
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            {{ wallet_stats.stats.protocol2|title }}
                            <span class="badge bg-primary rounded-pill">{{ wallet_stats.stats.daysUsed2 }} days</span>
                        </div>
                        <div class="list-group-item d-flex justify-content-between align-items-center">
                            {{ wallet_stats.stats.protocol3|title }}
                            <span class="badge bg-primary rounded-pill">{{ wallet_stats.stats.daysUsed3 }} days</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mb-4">
                <div class="card-header bg-warning text-dark">
                    <h5>Battle Group & Referrals</h5>
                </div>
                <div class="card-body">
                    <p><strong>Battle Group:</strong> #{{ wallet_stats.stats.battleGroup }}</p>
                    <p><strong>BG Rank:</strong> {{ wallet_stats.stats.bgRank }}</p>
                    <p><strong>Referrals:</strong> {{ wallet_stats.stats.referralCount }}</p>
                    {% if wallet_stats.stats.referralCode %}
                    <p><strong>Referral Code:</strong> {{ wallet_stats.stats.referralCode }}</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Otra informaciÃ³n importante -->
    <div class="row">
        <div class="col-md-12">
            <div class="card mb-4">
                <div class="card-header bg-secondary text-white">
                    <h5>Season One Allocation</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <p><strong>Base Allocation:</strong> {{ wallet_stats.seasonOneAllocation.calculatedAllocation }} PLUME</p>
                        </div>
                        <div class="col-md-4">
                            <p><strong>Boost:</strong> {{ wallet_stats.seasonOneAllocation.calculatedBoost }} PLUME</p>
                        </div>
                        <div class="col-md-4">
                            <p><strong>Total Airdrop:</strong> {{ wallet_stats.seasonOneAllocation.calculatedTotal }} PLUME</p>
                        </div>
                    </div>
                    {% if wallet_stats.seasonOneAllocation.questBonusActivatedCount %}
                    <p class="mt-2"><strong>Quests Completed:</strong> {{ wallet_stats.seasonOneAllocation.questBonusActivatedCount }}/8</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}